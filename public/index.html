<!-- Supabase Client -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- Main Application Script -->
    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://nxtxlueqzujqnsuqxmry.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im54dHhsdWVxenVqcW5zdXF4bXJ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA4Nzg4NjcsImV4cCI6MjA2NjQ1NDg2N30.Mq3vDWbk9bFhrOaK5MTOHZNNoh0w-878dH5ybOAp7m4';
        
        // Initialize Supabase client
        const { createClient } = supabase;
        const supabaseClient = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Global variables
        let dbManager = null;

        // Utility Functions
        function formatCurrency(value) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(value);
        }

        function hideLoading() {
            const loading = document.getElementById('loading-overlay');
            if (loading) {
                loading.classList.add('hidden');
            }
        }

        function showLoading() {
            const loading = document.getElementById('loading-overlay');
            if (loading) {
                loading.classList.remove('hidden');
            }
        }

        // Show/Hide Sections
        function showSection(sectionName, event) {
            if (event) {
                event.preventDefault();
            }

            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Remove active class from all menu items
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected section
            const section = document.getElementById(sectionName + '-section');
            if (section) {
                section.style.display = 'block';
            }
            
            // Add active class to clicked menu item
            if (event && event.currentTarget) {
                event.currentTarget.classList.add('active');
            }
        }

        // Modal Functions
        function openModal(modalType) {
            const modal = document.getElementById(modalType + '-modal');
            if (modal) {
                modal.classList.add('active');
            }
        }

        function closeModal(modalType) {
            const modal = document.getElementById(modalType + '-modal');
            if (modal) {
                modal.classList.remove('active');
            }
            
            // Clear form if it's funcion√°rio modal
            if (modalType === 'funcionario') {
                document.getElementById('funcionario-form').reset();
                document.getElementById('funcionario-id').value = '';
                document.getElementById('funcionario-modal-title').textContent = 'Novo Funcion√°rio';
            }
        }

        // Logout function (simplified - just reload page)
        function logout() {
            if (confirm('Deseja realmente sair do sistema?')) {
                window.location.reload();
            }
        }

        // Database Manager Class
        class DatabaseManager {
            constructor(client) {
                this.client = client;
            }

            // Funcion√°rios
            async addFuncionario(data) {
                try {
                    const { data: result, error } = await this.client
                        .from('funcionarios')
                        .insert([{
                            ...data,
                            created_at: new Date().toISOString()
                        }])
                        .select();

                    if (error) throw error;
                    console.log("Funcion√°rio adicionado:", result);
                    return result[0].id;
                } catch (error) {
                    console.error("Erro ao adicionar funcion√°rio:", error);
                    alert("Erro ao adicionar funcion√°rio!");
                }
            }

            async updateFuncionario(id, data) {
                try {
                    const { error } = await this.client
                        .from('funcionarios')
                        .update({
                            ...data,
                            updated_at: new Date().toISOString()
                        })
                        .eq('id', id);

                    if (error) throw error;
                    console.log("Funcion√°rio atualizado");
                } catch (error) {
                    console.error("Erro ao atualizar funcion√°rio:", error);
                    alert("Erro ao atualizar funcion√°rio!");
                }
            }

            async deleteFuncionario(id) {
                try {
                    const { error } = await this.client
                        .from('funcionarios')
                        .delete()
                        .eq('id', id);

                    if (error) throw error;
                    console.log("Funcion√°rio removido");
                } catch (error) {
                    console.error("Erro ao remover funcion√°rio:", error);
                    alert("Erro ao remover funcion√°rio!");
                }
            }

            // Transa√ß√µes
            async addTransacao(data) {
                try {
                    const { data: result, error } = await this.client
                        .from('transacoes')
                        .insert([{
                            ...data,
                            created_at: new Date().toISOString()
                        }])
                        .select();

                    if (error) throw error;
                    console.log("Transa√ß√£o adicionada:", result);
                    return result[0].id;
                } catch (error) {
                    console.error("Erro ao adicionar transa√ß√£o:", error);
                    alert("Erro ao adicionar transa√ß√£o!");
                }
            }

            // Contatos
            async addContato(data) {
                try {
                    const { data: result, error } = await this.client
                        .from('contatos')
                        .insert([{
                            ...data,
                            created_at: new Date().toISOString()
                        }])
                        .select();

                    if (error) throw error;
                    console.log("Contato adicionado:", result);
                    return result[0].id;
                } catch (error) {
                    console.error("Erro ao adicionar contato:", error);
                    alert("Erro ao adicionar contato!");
                }
            }
        }

        // Update Tables Functions
        function updateFuncionariosTable(funcionarios) {
            const tbody = document.getElementById('funcionarios-tbody');
            if (!tbody) return;
            
            if (funcionarios.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" style="text-align: center;">Nenhum funcion√°rio cadastrado</td></tr>';
                return;
            }

            tbody.innerHTML = funcionarios.map(f => `
                <tr>
                    <td>${f.nome || ''}</td>
                    <td>${f.cpf || ''}</td>
                    <td>${f.cargo || ''}</td>
                    <td>${f.departamento || ''}</td>
                    <td>${f.admissao ? new Date(f.admissao).toLocaleDateString('pt-BR') : ''}</td>
                    <td>${formatCurrency(f.salario || 0)}</td>
                    <td><span class="status-badge ${f.status}">${f.status || 'ativo'}</span></td>
                    <td class="action-buttons">
                        <button class="btn btn-small" onclick="editFuncionario('${f.id}')">‚úèÔ∏è</button>
                        <button class="btn btn-small btn-danger" onclick="deleteFuncionario('${f.id}')">üóëÔ∏è</button>
                    </td>
                </tr>
            `).join('');
        }

        function updateTransacoesTable(transacoes) {
            const tbody = document.getElementById('transacoes-tbody');
            if (!tbody) return;
            
            if (transacoes.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center;">Nenhuma transa√ß√£o registrada</td></tr>';
                return;
            }

            tbody.innerHTML = transacoes.slice(0, 10).map(t => `
                <tr>
                    <td>${t.data ? new Date(t.data).toLocaleDateString('pt-BR') : ''}</td>
                    <td>${t.descricao || ''}</td>
                    <td>${t.categoria || ''}</td>
                    <td><span class="status-badge ${t.tipo === 'receita' ? 'entrada' : 'saida'}">${t.tipo === 'receita' ? 'Entrada' : 'Sa√≠da'}</span></td>
                    <td>${formatCurrency(t.valor || 0)}</td>
                    <td>${t.status === 'pago' ? '‚úÖ Pago' : '‚è≥ Pendente'}</td>
                </tr>
            `).join('');
        }

        function updateContatosTable(contatos) {
            const tbody = document.getElementById('contatos-tbody');
            if (!tbody) return;
            
            if (contatos.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center;">Nenhum contato cadastrado</td></tr>';
                return;
            }

            tbody.innerHTML = contatos.map(c => `
                <tr>
                    <td>${c.nome || ''}</td>
                    <td><span class="status-badge ${c.tipo === 'cliente' ? 'entrada' : 'saida'}">${c.tipo === 'cliente' ? 'Cliente' : 'Fornecedor'}</span></td>
                    <td>${c.documento || ''}</td>
                    <td>${c.telefone || ''}</td>
                    <td>${c.email || ''}</td>
                    <td class="action-buttons">
                        <button class="btn btn-small">‚úèÔ∏è</button>
                        <button class="btn btn-small btn-danger">üóëÔ∏è</button>
                    </td>
                </tr>
            `).join('');
        }

        // Setup Real-time Listeners
        async function setupRealtimeListeners() {
            // Funcion√°rios subscription
            supabaseClient
                .channel('funcionarios_changes')
                .on('postgres_changes', { event: '*', schema: 'public', table: 'funcionarios' }, 
                    async () => {
                        await loadFuncionarios();
                    }
                )
                .subscribe();

            // Transa√ß√µes subscription
            supabaseClient
                .channel('transacoes_changes')
                .on('postgres_changes', { event: '*', schema: 'public', table: 'transacoes' }, 
                    async () => {
                        await loadTransacoes();
                    }
                )
                .subscribe();

            // Contatos subscription
            supabaseClient
                .channel('contatos_changes')
                .on('postgres_changes', { event: '*', schema: 'public', table: 'contatos' }, 
                    async () => {
                        await loadContatos();
                    }
                )
                .subscribe();

            // Initial load
            await loadFuncionarios();
            await loadTransacoes();
            await loadContatos();
        }

        // Load data functions
        async function loadFuncionarios() {
            try {
                const { data, error } = await supabaseClient
                    .from('funcionarios')
                    .select('*')
                    .order('nome');

                if (error) throw error;

                let totalSalario = 0;
                let ativos = 0;
                let inativos = 0;

                data.forEach(f => {
                    if (f.status === 'ativo') {
                        ativos++;
                        totalSalario += parseFloat(f.salario || 0);
                    } else {
                        inativos++;
                    }
                });

                // Update stats
                document.getElementById('total-funcionarios').textContent = data.length;
                document.getElementById('funcionarios-ativos').textContent = ativos;
                document.getElementById('funcionarios-inativos').textContent = inativos;
                document.getElementById('folha-pagamento').textContent = formatCurrency(totalSalario);

                // Update table
                updateFuncionariosTable(data);
            } catch (error) {
                console.error('Error loading funcionarios:', error);
            }
        }

        async function loadTransacoes() {
            try {
                const { data, error } = await supabaseClient
                    .from('transacoes')
                    .select('*')
                    .order('data', { ascending: false });

                if (error) throw error;

                let totalEntradas = 0;
                let totalSaidas = 0;

                data.forEach(t => {
                    if (t.tipo === 'receita') {
                        totalEntradas += parseFloat(t.valor || 0);
                    } else {
                        totalSaidas += parseFloat(t.valor || 0);
                    }
                });

                // Update dashboard
                document.getElementById('total-entradas').textContent = formatCurrency(totalEntradas);
                document.getElementById('total-saidas').textContent = formatCurrency(totalSaidas);
                document.getElementById('resultado-mes').textContent = formatCurrency(totalEntradas - totalSaidas);

                // Update table
                updateTransacoesTable(data);
            } catch (error) {
                console.error('Error loading transacoes:', error);
            }
        }

        async function loadContatos() {
            try {
                const { data, error } = await supabaseClient
                    .from('contatos')
                    .select('*')
                    .order('nome');

                if (error) throw error;

                let clientes = 0;
                let fornecedores = 0;

                data.forEach(c => {
                    if (c.tipo === 'cliente') {
                        clientes++;
                    } else {
                        fornecedores++;
                    }
                });

                // Update stats
                document.getElementById('total-contatos').textContent = data.length;
                document.getElementById('total-clientes').textContent = clientes;
                document.getElementById('total-fornecedores').textContent = fornecedores;

                // Update table
                updateContatosTable(data);
            } catch (error) {
                console.error('Error loading contatos:', error);
            }
        }

        // Global Functions
        window.editFuncionario = async (id) => {
            try {
                const { data, error } = await supabaseClient
                    .from('funcionarios')
                    .select('*')
                    .eq('id', id)
                    .single();

                if (error) throw error;
                
                // Fill form
                document.getElementById('funcionario-id').value = id;
                document.getElementById('funcionario-nome').value = data.nome || '';
                document.getElementById('funcionario-cpf').value = data.cpf || '';
                document.getElementById('funcionario-email').value = data.email || '';
                document.getElementById('funcionario-telefone').value = data.telefone || '';
                document.getElementById('funcionario-cargo').value = data.cargo || '';
                document.getElementById('funcionario-departamento').value = data.departamento || '';
                document.getElementById('funcionario-admissao').value = data.admissao || '';
                document.getElementById('funcionario-salario').value = formatCurrency(data.salario || 0);
                document.getElementById('funcionario-status').value = data.status || 'ativo';
                
                document.getElementById('funcionario-modal-title').textContent = 'Editar Funcion√°rio';
                openModal('funcionario');
            } catch (error) {
                console.error('Error loading funcionario:', error);
                alert('Erro ao carregar funcion√°rio');
            }
        };

        window.deleteFuncionario = async (id) => {
            if (confirm('Tem certeza que deseja remover este funcion√°rio?')) {
                await dbManager.deleteFuncionario(id);
            }
        };

        // Popular clientes
        window.popularClientes = async () => {
            const clientesIniciais = [
                {
                    tipo: 'cliente',
                    nome: 'AGRITEX COMERCIAL AGRICOLA LTDA',
                    documento: '06.098.802/0001-62',
                    email: 'financeiro.pagar@agritex.com.br',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'AGRICULTURA E PECUARIA CAMPONOVENSE LTDA',
                    documento: '39.429.668/0001-94',
                    email: 'financeiro@agrocam.com.br',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'ARGO INTELIGENCIA DIGITAL LTDA',
                    documento: '39.752.281/0001-74',
                    email: 'FINANCEIRO@ARGOINTELIGENCIA.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'CARISMA INVESTIMENTOS E PARTICIPACOES S/A',
                    documento: '07.701.775/0001-33',
                    email: 'CARISMAPVA@GMAIL.COM',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'CARVALIMA TRANSPORTES LTDA',
                    documento: '35.070.814/0001-51',
                    email: 'VALDECIR@CARVALIMA.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'COMPLEXO TURISTICO SANTA ROSA PANTANAL HOTEIS LTDA',
                    documento: '03.785.623/0001-05',
                    email: 'FINANCEIRO@SANTAROSAPANTANAL.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'DUILIO NAVES JUNQUEIRA JUNIOR',
                    documento: '343.588.541-68',
                    email: 'duilio@odomprimeculaba.com.br',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'E. R. DE FIGUEIREDO & CIA LTDA',
                    documento: '30.541.222/0001-82',
                    email: 'elsonramos@live.com',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'ESTANCIA BAHIA EVENTOS LTDA',
                    documento: '26.373.673/0001-80',
                    email: 'CONTABILIDADE@ESTANCIABAHIA.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'EUGENIO ROBERTO BERGAMIM',
                    documento: '041.476.781-06',
                    email: '',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'GA SERVICE - GESTAO ADMINISTRATIVA LTDA',
                    documento: '10.942.203/0001-50',
                    email: 'NOTIFICACOES@GRUPOALDO.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'GRF INCORPORADORA E CONSTRUTORA LTDA',
                    documento: '32.187.187/0001-70',
                    email: 'FISCAL@EXATUSONLINE.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'NOGUEIRA PARTICIPACOES E EMPREENDIMENTOS LTDA',
                    documento: '12.645.475/0001-14',
                    email: 'ADRIANO@NOGUEIRACONTABIL.COM',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'NOVA ALIANCA AGRO LTDA',
                    documento: '28.080.165/0001-30',
                    email: 'EDSON@NOVAALIANCAAGRO.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'R.O.G HOLDING LTDA',
                    documento: '40.988.927/0001-04',
                    email: 'RAPHAELCOALASOCIAL@GMAIL.COM',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'RICARDO GOMES DOS SANTOS',
                    documento: '784.754.651-53',
                    email: 'ricardo@tunnaseguros.com.br',
                    telefone: '65992517629'
                },
                {
                    tipo: 'cliente',
                    nome: 'SOLUCAO TECNICA COMERCIO E SERVICOS DE EQUIPAMENTOS ELETRONICOS LTDA',
                    documento: '04.164.120/0001-85',
                    email: 'ADMINISTRATIVO@SOLUCAOTECNICA.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'WATT - DISTRIBUIDORA BRASIL. DE COMBUSTIVEIS E DERIVADOS DE PETROLEO LTDA',
                    documento: '03.908.643/0001-26',
                    email: 'GERENTECOMERCIAL@WATTBRAS.COM.BR',
                    telefone: ''
                }
            ];

            if (confirm('Deseja importar os 18 clientes iniciais? Isso n√£o duplicar√° clientes existentes.')) {
                showLoading();
                try {
                    for (const cliente of clientesIniciais) {
                        // Verificar se cliente j√° existe pelo CNPJ
                        const { data: existing } = await supabaseClient
                            .from('contatos')
                            .select('id')
                            .eq('documento', cliente.documento)
                            .single();
                        
                        if (!existing) {
                            await supabaseClient
                                .from('contatos')
                                .insert([{
                                    ...cliente,
                                    created_at: new Date().toISOString()
                                }]);
                            console.log(`Cliente ${cliente.nome} adicionado`);
                        } else {
                            console.log(`Cliente ${cliente.nome} j√° existe`);
                        }
                    }
                    alert('Importa√ß√£o conclu√≠da!');
                    await loadContatos();
                } catch (error) {
                    console.error('Erro na importa√ß√£o:', error);
                    alert('Erro ao importar clientes');
                } finally {
                    hideLoading();
                }
            }
        };

        // Initialize Application
        async function initializeApp() {
            try {
                // Update user info
                document.querySelectorAll('.user-name').forEach(el => {
                    el.textContent = 'Share Brasil';
                });

                // Initialize Database Manager
                dbManager = new DatabaseManager(supabaseClient);
                window.dbManager = dbManager;

                // Setup listeners
                await setupRealtimeListeners();

                // Setup forms
                setupForms();

                // Hide loading
                hideLoading();

                console.log('Application initialized successfully');
            } catch (error) {
                console.error('Error initializing application:', error);
                hideLoading();
                alert('Erro ao inicializar o sistema. Verifique a conex√£o com o banco de dados.');
            }
        }

        // Setup Forms
        function setupForms() {
            // Funcion√°rio Form
            const funcionarioForm = document.getElementById('funcionario-form');
            if (funcionarioForm) {
                funcionarioForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const id = document.getElementById('funcionario-id').value;
                    const data = {
                        nome: document.getElementById('funcionario-nome').value,
                        cpf: document.getElementById('funcionario-cpf').value,
                        email: document.getElementById('funcionario-email').value,
                        telefone: document.getElementById('funcionario-telefone').value,
                        cargo: document.getElementById('funcionario-cargo').value,
                        departamento: document.getElementById('funcionario-departamento').value,
                        admissao: document.getElementById('funcionario-admissao').value,
                        salario: document.getElementById('funcionario-salario').value.replace(/[^\d,]/g, '').replace(',', '.'),
                        status: document.getElementById('funcionario-status').value
                    };

                    if (id) {
                        await dbManager.updateFuncionario(id, data);
                    } else {
                        await dbManager.addFuncionario(data);
                    }
                    
                    closeModal('funcionario');
                    e.target.reset();
                });
            }

            // Lan√ßamento Form
            const lancamentoForm = document.getElementById('lancamento-form');
            if (lancamentoForm) {
                lancamentoForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const data = {
                        tipo: document.getElementById('lancamento-tipo').value,
                        descricao: document.getElementById('lancamento-descricao').value,
                        categoria: document.getElementById('lancamento-categoria').value,
                        valor: document.getElementById('lancamento-valor').value.replace(/[^\d,]/g, '').replace(',', '.'),
                        data: document.getElementById('lancamento-data').value,
                        status: 'pendente'
                    };

                    await dbManager.addTransacao(data);
                    
                    closeModal('lancamento');
                    e.target.reset();
                });
            }

            // Contato Form
            const contatoForm = document.getElementById('contato-form');
            if (contatoForm) {
                contatoForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const data = {
                        tipo: document.getElementById('contato-tipo').value,
                        nome: document.getElementById('contato-nome').value,
                        documento: document.getElementById('contato-documento').value,
                        email: document.getElementById('contato-email').value,
                        telefone: document.getElementById('contato-telefone').value
                    };

                    await dbManager.addContato(data);
                    
                    closeModal('contato');
                    e.target.reset();
                });
            }

            // Format currency inputs
            document.querySelectorAll('input[placeholder*="R$"]').forEach(input => {
                input.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    value = (value / 100).toFixed(2);
                    value = value.replace('.', ',');
                    e.target.value = 'R$ ' + value;
                });
            });

            // Notes autosave
            const notesContent = document.querySelector('.notes-content');
            if (notesContent) {
                notesContent.addEventListener('blur', function() {
                    localStorage.setItem('quickNotes', this.value);
                });

                // Load saved notes
                const savedNotes = localStorage.getItem('quickNotes');
                if (savedNotes) {
                    notesContent.value = savedNotes;
                }
            }
        }

        // Close modals when clicking outside
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });

        // Check authentication on load
        window.addEventListener('load', async () => {
            showLoading();
            
            // Check if user is logged in
            const { data: { session } } = await supabaseClient.auth.getSession();
            
            if (session) {
                currentUser = session.user;
                hideLogin();
                await initializeApp();
            } else {
                hideLoading();
                showLogin();
            }
        });

        // Make functions available globally
        window.showSection = showSection;
        window.openModal = openModal;
        window.closeModal = closeModal;
        window.formatCurrency = formatCurrency;
        window.logout = logout;
    </script>
</body>
</html><!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Share Brasil - Dashboard Gestor</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: #F5F6FA;
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 250px;
            background: #1E3A5F;
            color: white;
            padding: 1.5rem 0;
            position: fixed;
            height: 100%;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 0 1.5rem 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar h2 {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .sidebar-menu {
            padding-top: 1rem;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            color: white;
            text-decoration: none;
            transition: all 0.3s;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-size: 1rem;
        }

        .menu-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .menu-item.active {
            background: #2C5282;
            border-left: 4px solid #4A90E2;
        }

        .menu-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Main Content */
        .main-content {
            margin-left: 250px;
            flex: 1;
            padding: 2rem;
        }

        /* Header */
        .page-header {
            background: white;
            padding: 1.5rem 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .page-title {
            font-size: 1.8rem;
            color: #1E3A5F;
            font-weight: 600;
        }

        .page-subtitle {
            color: #6B7280;
            margin-top: 0.5rem;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: #4A90E2;
            color: white;
        }

        .btn-primary:hover {
            background: #357ABD;
        }

        .btn-danger {
            background: #EF4444;
            color: white;
        }

        .btn-danger:hover {
            background: #DC2626;
        }

        /* Dashboard Cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .dashboard-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .card-icon.green {
            background: #10B981;
            color: white;
        }

        .card-icon.red {
            background: #EF4444;
            color: white;
        }

        .card-icon.blue {
            background: #3B82F6;
            color: white;
        }

        .card-icon.purple {
            background: #8B5CF6;
            color: white;
        }

        .card-value {
            font-size: 2rem;
            font-weight: 700;
            color: #1E3A5F;
            margin-bottom: 0.5rem;
        }

        .card-label {
            color: #6B7280;
            font-size: 0.9rem;
        }

        .card-change {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .card-change.positive {
            color: #10B981;
        }

        .card-change.negative {
            color: #EF4444;
        }

        /* Charts Section */
        .charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .chart-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #1E3A5F;
        }

        .chart-filters {
            display: flex;
            gap: 0.5rem;
        }

        .filter-select {
            padding: 0.5rem 1rem;
            border: 1px solid #E5E7EB;
            border-radius: 6px;
            background: white;
            color: #374151;
            font-size: 0.9rem;
        }

        /* Table */
        .table-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .search-box {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background: #F3F4F6;
            border-radius: 8px;
            width: 300px;
        }

        .search-input {
            border: none;
            background: none;
            outline: none;
            flex: 1;
            font-size: 0.9rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            text-align: left;
            padding: 1rem;
            border-bottom: 2px solid #E5E7EB;
            color: #6B7280;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid #F3F4F6;
        }

        tr:hover {
            background: #F9FAFB;
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .status-badge.entrada {
            background: #D1FAE5;
            color: #065F46;
        }

        .status-badge.saida {
            background: #FEE2E2;
            color: #991B1B;
        }

        .status-badge.ativo {
            background: #D1FAE5;
            color: #065F46;
        }

        .status-badge.inativo {
            background: #F3F4F6;
            color: #6B7280;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1E3A5F;
        }

        .close-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: #F3F4F6;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: #374151;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #E5E7EB;
            border-radius: 6px;
            font-size: 1rem;
        }

        .form-input:focus {
            outline: none;
            border-color: #4A90E2;
        }

        .form-select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #E5E7EB;
            border-radius: 6px;
            font-size: 1rem;
            background: white;
        }

        /* Calendar */
        .calendar-container {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            position: relative;
        }

        .calendar-day:hover {
            background: #F3F4F6;
        }

        .calendar-day.has-expense {
            background: #FEE2E2;
            color: #991B1B;
            font-weight: 600;
        }

        /* Notes */
        .notes-container {
            background: #FEFCE8;
            padding: 1.5rem;
            border-radius: 10px;
            border: 2px solid #FDE047;
            margin-top: 1rem;
        }

        .notes-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            color: #854D0E;
            font-weight: 600;
        }

        .notes-content {
            min-height: 100px;
            background: none;
            border: none;
            width: 100%;
            resize: vertical;
            font-family: inherit;
            color: #854D0E;
            outline: none;
        }

        /* Chart Placeholder */
        .chart-placeholder {
            height: 300px;
            background: #F3F4F6;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6B7280;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .btn-small {
            padding: 0.5rem;
            font-size: 0.85rem;
        }

        /* Loading */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            color: #6B7280;
        }

        /* Loading state */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-overlay.hidden {
            display: none;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* User Info Section */
        .user-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .user-info-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: white;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
        }

        .logout-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 0.5rem;
        }



        /* Responsive */
        @media (max-width: 1024px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s;
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div>
            <div class="loading-spinner"></div>
            <p style="margin-top: 1rem; color: #666;">Carregando sistema...</p>
            <p style="margin-top: 0.5rem; color: #999; font-size: 0.9rem;">Conectando ao Supabase...</p>
        </div>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Share Brasil</h2>
        </div>
        <nav class="sidebar-menu">
            <a href="#" class="menu-item active" onclick="showSection('dashboard', event)">
                <span class="menu-icon">üìä</span>
                Dashboard
            </a>
            <a href="#" class="menu-item" onclick="showSection('financeiro', event)">
                <span class="menu-icon">üí∞</span>
                Financeiro
            </a>
            <a href="#" class="menu-item" onclick="showSection('contatos', event)">
                <span class="menu-icon">üë•</span>
                Contatos
            </a>
            <a href="#" class="menu-item" onclick="showSection('funcionarios', event)">
                <span class="menu-icon">üë®‚Äçüíº</span>
                Funcion√°rios
            </a>
            <a href="#" class="menu-item" onclick="showSection('inadimplencia', event)">
                <span class="menu-icon">‚ö†Ô∏è</span>
                Inadimpl√™ncia
            </a>
            <a href="#" class="menu-item" onclick="showSection('notafiscal', event)">
                <span class="menu-icon">üìÑ</span>
                Nota Fiscal
            </a>
            <a href="#" class="menu-item" onclick="showSection('bloconotas', event)">
                <span class="menu-icon">üìù</span>
                Bloco de Notas
            </a>
            <a href="#" class="menu-item" onclick="showSection('relatorios', event)">
                <span class="menu-icon">üìà</span>
                Relat√≥rios
            </a>
            <a href="#" class="menu-item" onclick="showSection('backup', event)">
                <span class="menu-icon">üíæ</span>
                Backup
            </a>
            <a href="#" class="menu-item" onclick="showSection('configuracoes', event)">
                <span class="menu-icon">‚öôÔ∏è</span>
                Configura√ß√µes
            </a>
        </nav>
        
        <!-- User Info Section -->
        <div class="user-info">
            <div class="user-info-content">
                <div class="user-profile">
                    <div class="user-avatar">üë§</div>
                    <span class="user-name" style="font-size: 0.9rem;">Share Brasil</span>
                </div>
                <button onclick="logout()" class="logout-btn" title="Sair">
                    üö™
                </button>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Section -->
        <section id="dashboard-section" class="content-section">
            <!-- Header -->
            <div class="page-header">
                <div>
                    <h1 class="page-title">Dashboard - Resumo Executivo</h1>
                    <p class="page-subtitle">Vis√£o geral r√°pida das finan√ßas do m√™s atual</p>
                </div>
                <div class="header-actions">
                    <select class="filter-select">
                        <option>Janeiro</option>
                        <option>Fevereiro</option>
                        <option>Mar√ßo</option>
                    </select>
                    <select class="filter-select">
                        <option>2025</option>
                        <option>2024</option>
                    </select>
                    <button class="btn btn-primary" onclick="openModal('lancamento')">
                        ‚ûï Novo Lan√ßamento
                    </button>
                </div>
            </div>

            <!-- Dashboard Cards -->
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-icon green">üìà</div>
                    <div class="card-change positive">+12.5%</div>
                    <div class="card-label">Total Entradas</div>
                    <div class="card-value" id="total-entradas">R$ 0,00</div>
                    <div style="font-size: 0.85rem; color: #6B7280; margin-top: 0.5rem;">
                        Baseado em contas recebidas
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-icon red">üìâ</div>
                    <div class="card-change negative">+8.3%</div>
                    <div class="card-label">Total Sa√≠das</div>
                    <div class="card-value" id="total-saidas">R$ 0,00</div>
                    <div style="font-size: 0.85rem; color: #6B7280; margin-top: 0.5rem;">
                        Baseado em contas pagas
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-icon blue">üí∞</div>
                    <div class="card-change positive">0%</div>
                    <div class="card-label">Resultado do M√™s</div>
                    <div class="card-value" id="resultado-mes">R$ 0,00</div>
                    <div style="font-size: 0.85rem; color: #6B7280; margin-top: 0.5rem;">
                        Entradas - Sa√≠das
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-icon purple">üí≥</div>
                    <div class="card-label">Pago na √öltima Semana</div>
                    <div class="card-value" style="color: #EF4444;" id="pago-semana">-R$ 0,00</div>
                    <div style="font-size: 0.85rem; color: #6B7280; margin-top: 0.5rem;">
                        Pagamentos √∫ltimos 7 dias
                    </div>
                </div>
            </div>

            <!-- Charts -->
            <div class="charts-container">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">An√°lise por Categoria</h3>
                        <div class="chart-filters">
                            <select class="filter-select">
                                <option>√öltimos 30 dias</option>
                                <option>√öltimos 60 dias</option>
                                <option>√öltimos 90 dias</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-placeholder">
                        <canvas id="categoriaChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">DRE - Demonstra√ß√£o de Resultado</h3>
                    </div>
                    <div class="chart-placeholder">
                        <canvas id="dreChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Recent Transactions -->
            <div class="table-card">
                <div class="table-header">
                    <h3 class="chart-title">√öltimas Transa√ß√µes</h3>
                    <div class="search-box">
                        <span>üîç</span>
                        <input type="text" class="search-input" placeholder="Pesquisar..." id="search-transacoes">
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Descri√ß√£o</th>
                            <th>Categoria</th>
                            <th>Tipo</th>
                            <th>Valor</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="transacoes-tbody">
                        <tr>
                            <td colspan="6" class="loading">Carregando transa√ß√µes...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Funcion√°rios Section -->
        <section id="funcionarios-section" class="content-section" style="display: none;">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Gest√£o de Funcion√°rios</h1>
                    <p class="page-subtitle">Cadastro e controle de funcion√°rios</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="openModal('funcionario')">
                        ‚ûï Novo Funcion√°rio
                    </button>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-icon green">üë•</div>
                    <div class="card-label">Total de Funcion√°rios</div>
                    <div class="card-value" id="total-funcionarios">0</div>
                </div>
                <div class="dashboard-card">
                    <div class="card-icon blue">‚úÖ</div>
                    <div class="card-label">Ativos</div>
                    <div class="card-value" id="funcionarios-ativos">0</div>
                </div>
                <div class="dashboard-card">
                    <div class="card-icon red">‚ùå</div>
                    <div class="card-label">Inativos</div>
                    <div class="card-value" id="funcionarios-inativos">0</div>
                </div>
                <div class="dashboard-card">
                    <div class="card-icon purple">üí∞</div>
                    <div class="card-label">Folha de Pagamento</div>
                    <div class="card-value" id="folha-pagamento">R$ 0,00</div>
                </div>
            </div>

            <!-- Funcion√°rios Table -->
            <div class="table-card">
                <div class="table-header">
                    <h3 class="chart-title">Lista de Funcion√°rios</h3>
                    <div class="search-box">
                        <span>üîç</span>
                        <input type="text" class="search-input" placeholder="Pesquisar funcion√°rios..." id="search-funcionarios">
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>CPF</th>
                            <th>Cargo</th>
                            <th>Departamento</th>
                            <th>Admiss√£o</th>
                            <th>Sal√°rio</th>
                            <th>Status</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="funcionarios-tbody">
                        <tr>
                            <td colspan="8" class="loading">Carregando funcion√°rios...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Financeiro Section -->
        <section id="financeiro-section" class="content-section" style="display: none;">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Gest√£o Financeira</h1>
                    <p class="page-subtitle">Controle de entradas e sa√≠das</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="openModal('receita')">
                        ‚ûï Nova Receita
                    </button>
                    <button class="btn btn-primary" onclick="openModal('despesa')">
                        ‚ûñ Nova Despesa
                    </button>
                </div>
            </div>

            <!-- Calendar View -->
            <div class="calendar-container">
                <div class="calendar-header">
                    <h3 class="chart-title">Calend√°rio de Despesas - Janeiro 2025</h3>
                    <div class="chart-filters">
                        <button class="btn">‚¨ÖÔ∏è</button>
                        <button class="btn">‚û°Ô∏è</button>
                    </div>
                </div>
                <div class="calendar-grid">
                    <!-- Week days -->
                    <div style="text-align: center; font-weight: 600; color: #6B7280;">Dom</div>
                    <div style="text-align: center; font-weight: 600; color: #6B7280;">Seg</div>
                    <div style="text-align: center; font-weight: 600; color: #6B7280;">Ter</div>
                    <div style="text-align: center; font-weight: 600; color: #6B7280;">Qua</div>
                    <div style="text-align: center; font-weight: 600; color: #6B7280;">Qui</div>
                    <div style="text-align: center; font-weight: 600; color: #6B7280;">Sex</div>
                    <div style="text-align: center; font-weight: 600; color: #6B7280;">S√°b</div>
                    <!-- Calendar days will be generated here -->
                </div>
            </div>
        </section>

        <!-- Contatos Section -->
        <section id="contatos-section" class="content-section" style="display: none;">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Contatos</h1>
                    <p class="page-subtitle">Gerencie clientes e fornecedores</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="openModal('contato')">
                        ‚ûï Novo Contato
                    </button>
                    <button class="btn" onclick="popularClientes()" title="Popular clientes iniciais">
                        üì• Importar Clientes
                    </button>
                </div>
            </div>

            <!-- Contact Filters -->
            <div class="dashboard-grid" style="margin-bottom: 2rem;">
                <button class="dashboard-card" style="cursor: pointer;">
                    <div class="card-icon blue">üë•</div>
                    <div class="card-label">Todos</div>
                    <div class="card-value" id="total-contatos">0</div>
                </button>
                <button class="dashboard-card" style="cursor: pointer;">
                    <div class="card-icon green">üë§</div>
                    <div class="card-label">Clientes</div>
                    <div class="card-value" id="total-clientes">0</div>
                </button>
                <button class="dashboard-card" style="cursor: pointer;">
                    <div class="card-icon purple">üè¢</div>
                    <div class="card-label">Fornecedores</div>
                    <div class="card-value" id="total-fornecedores">0</div>
                </button>
            </div>

            <!-- Contacts Table -->
            <div class="table-card">
                <div class="table-header">
                    <h3 class="chart-title">Lista de Contatos</h3>
                    <div class="search-box">
                        <span>üîç</span>
                        <input type="text" class="search-input" placeholder="Pesquisar contatos...">
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Tipo</th>
                            <th>CNPJ/CPF</th>
                            <th>Telefone</th>
                            <th>Email</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="contatos-tbody">
                        <tr>
                            <td colspan="6" class="loading">Carregando contatos...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Nota Fiscal Section -->
        <section id="notafiscal-section" class="content-section" style="display: none;">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Notas Fiscais</h1>
                    <p class="page-subtitle">Gerencie e organize suas notas fiscais</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="openModal('notafiscal')">
                        üìé Anexar Nota Fiscal
                    </button>
                </div>
            </div>

            <!-- Monthly Folders -->
            <div class="dashboard-grid">
                <div class="dashboard-card" style="cursor: pointer;">
                    <div class="card-icon blue">üìÅ</div>
                    <div class="card-label">Janeiro 2025</div>
                    <div class="card-value">12</div>
                    <div style="font-size: 0.85rem; color: #6B7280;">notas fiscais</div>
                </div>
                <div class="dashboard-card" style="cursor: pointer;">
                    <div class="card-icon blue">üìÅ</div>
                    <div class="card-label">Dezembro 2024</div>
                    <div class="card-value">28</div>
                    <div style="font-size: 0.85rem; color: #6B7280;">notas fiscais</div>
                </div>
                <div class="dashboard-card" style="cursor: pointer;">
                    <div class="card-icon blue">üìÅ</div>
                    <div class="card-label">Novembro 2024</div>
                    <div class="card-value">25</div>
                    <div style="font-size: 0.85rem; color: #6B7280;">notas fiscais</div>
                </div>
            </div>

            <!-- Recent Notes -->
            <div class="table-card">
                <div class="table-header">
                    <h3 class="chart-title">Notas Fiscais Recentes</h3>
                    <div class="search-box">
                        <span>üîç</span>
                        <input type="text" class="search-input" placeholder="Pesquisar notas...">
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>N√∫mero</th>
                            <th>Cliente/Fornecedor</th>
                            <th>Valor</th>
                            <th>Tipo</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>25/01/2025</td>
                            <td>NF-2025-001</td>
                            <td>WATT - DISTRIBUIDORA</td>
                            <td>R$ 5.432,10</td>
                            <td><span class="status-badge entrada">Entrada</span></td>
                            <td>
                                <button class="btn" style="padding: 0.5rem;">üìÑ</button>
                                <button class="btn" style="padding: 0.5rem;">‚¨áÔ∏è</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Bloco de Notas Section -->
        <section id="bloconotas-section" class="content-section" style="display: none;">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Bloco de Notas</h1>
                    <p class="page-subtitle">Anota√ß√µes r√°pidas e lembretes</p>
                </div>
            </div>

            <div class="notes-container">
                <div class="notes-header">
                    <span>üìù</span>
                    <span>Notas R√°pidas</span>
                </div>
                <textarea class="notes-content" placeholder="Digite suas anota√ß√µes aqui...">- Reuni√£o com contador √†s 15h
- Verificar relat√≥rio PR-MDL
- Enviar documentos DECEA at√© sexta
- Pagar fornecedor XYZ at√© dia 30</textarea>
            </div>

            <div class="dashboard-grid" style="margin-top: 2rem;">
                <div class="dashboard-card">
                    <div class="card-icon purple">üìå</div>
                    <div class="card-label">Tarefas Pendentes</div>
                    <ul style="margin-top: 1rem; padding-left: 1.5rem; color: #6B7280;">
                        <li>Emitir NF para cliente ABC</li>
                        <li>Conferir extrato banc√°rio</li>
                        <li>Atualizar planilha de custos</li>
                    </ul>
                </div>
                <div class="dashboard-card">
                    <div class="card-icon green">‚úÖ</div>
                    <div class="card-label">Conclu√≠das Hoje</div>
                    <ul style="margin-top: 1rem; padding-left: 1.5rem; color: #6B7280;">
                        <li style="text-decoration: line-through;">Pagar conta de luz</li>
                        <li style="text-decoration: line-through;">Enviar relat√≥rio mensal</li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <!-- Modals -->
    <!-- Funcion√°rio Modal -->
    <div class="modal" id="funcionario-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="funcionario-modal-title">Novo Funcion√°rio</h2>
                <button class="close-btn" onclick="closeModal('funcionario')">‚úï</button>
            </div>
            <form id="funcionario-form">
                <input type="hidden" id="funcionario-id">
                <div class="form-group">
                    <label class="form-label">Nome Completo *</label>
                    <input type="text" class="form-input" id="funcionario-nome" required>
                </div>
                <div class="form-group">
                    <label class="form-label">CPF *</label>
                    <input type="text" class="form-input" id="funcionario-cpf" placeholder="000.000.000-00" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="funcionario-email">
                </div>
                <div class="form-group">
                    <label class="form-label">Telefone</label>
                    <input type="tel" class="form-input" id="funcionario-telefone" placeholder="(00) 00000-0000">
                </div>
                <div class="form-group">
                    <label class="form-label">Cargo *</label>
                    <input type="text" class="form-input" id="funcionario-cargo" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Departamento</label>
                    <select class="form-select" id="funcionario-departamento">
                        <option value="">Selecione</option>
                        <option value="Administrativo">Administrativo</option>
                        <option value="Operacional">Operacional</option>
                        <option value="Financeiro">Financeiro</option>
                        <option value="RH">RH</option>
                        <option value="TI">TI</option>
                        <option value="Comercial">Comercial</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Data de Admiss√£o *</label>
                    <input type="date" class="form-input" id="funcionario-admissao" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Sal√°rio</label>
                    <input type="text" class="form-input" id="funcionario-salario" placeholder="R$ 0,00">
                </div>
                <div class="form-group">
                    <label class="form-label">Status</label>
                    <select class="form-select" id="funcionario-status">
                        <option value="ativo">Ativo</option>
                        <option value="inativo">Inativo</option>
                        <option value="ferias">F√©rias</option>
                        <option value="afastado">Afastado</option>
                    </select>
                </div>
                <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn" onclick="closeModal('funcionario')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Lan√ßamento Modal -->
    <div class="modal" id="lancamento-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Novo Lan√ßamento</h2>
                <button class="close-btn" onclick="closeModal('lancamento')">‚úï</button>
            </div>
            <form id="lancamento-form">
                <div class="form-group">
                    <label class="form-label">Tipo</label>
                    <select class="form-select" id="lancamento-tipo">
                        <option value="receita">Receita</option>
                        <option value="despesa">Despesa</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Descri√ß√£o</label>
                    <input type="text" class="form-input" id="lancamento-descricao" placeholder="Descri√ß√£o do lan√ßamento" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Categoria</label>
                    <select class="form-select" id="lancamento-categoria">
                        <option>Selecione uma categoria</option>
                        <option>Despesas Share</option>
                        <option>Ressarcim. Pago</option>
                        <option>Contratos</option>
                        <option>Outros</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Valor</label>
                    <input type="text" class="form-input" id="lancamento-valor" placeholder="R$ 0,00" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Data de Vencimento</label>
                    <input type="date" class="form-input" id="lancamento-data" required>
                </div>
                <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn" onclick="closeModal('lancamento')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Contato Modal -->
    <div class="modal" id="contato-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Novo Contato</h2>
                <button class="close-btn" onclick="closeModal('contato')">‚úï</button>
            </div>
            <form id="contato-form">
                <div class="form-group">
                    <label class="form-label">Tipo de Contato</label>
                    <select class="form-select" id="contato-tipo">
                        <option value="cliente">Cliente</option>
                        <option value="fornecedor">Fornecedor</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Nome/Raz√£o Social</label>
                    <input type="text" class="form-input" id="contato-nome" placeholder="Nome completo ou raz√£o social" required>
                </div>
                <div class="form-group">
                    <label class="form-label">CNPJ/CPF</label>
                    <input type="text" class="form-input" id="contato-documento" placeholder="00.000.000/0000-00">
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="contato-email" placeholder="email@exemplo.com">
                </div>
                <div class="form-group">
                    <label class="form-label">Telefone</label>
                    <input type="tel" class="form-input" id="contato-telefone" placeholder="(00) 00000-0000">
                </div>
                <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn" onclick="closeModal('contato')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Nota Fiscal Modal -->
    <div class="modal" id="notafiscal-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Anexar Nota Fiscal</h2>
                <button class="close-btn" onclick="closeModal('notafiscal')">‚úï</button>
            </div>
            <form>
                <div class="form-group">
                    <label class="form-label">N√∫mero da Nota</label>
                    <input type="text" class="form-input" placeholder="NF-0000">
                </div>
                <div class="form-group">
                    <label class="form-label">Cliente/Fornecedor</label>
                    <select class="form-select">
                        <option>Selecione</option>
                        <option>WATT - DISTRIBUIDORA</option>
                        <option>GA SERVICE</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Data de Emiss√£o</label>
                    <input type="date" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">Valor</label>
                    <input type="text" class="form-input" placeholder="R$ 0,00">
                </div>
                <div class="form-group">
                    <label class="form-label">Arquivo</label>
                    <input type="file" class="form-input" accept=".pdf,.xml">
                </div>
                <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn" onclick="closeModal('notafiscal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Anexar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Supabase Client -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- Main Application Script -->
    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://nxtxlueqzujqnsuqxmry.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im54dHhsdWVxenVqcW5zdXF4bXJ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA4Nzg4NjcsImV4cCI6MjA2NjQ1NDg2N30.Mq3vDWbk9bFhrOaK5MTOHZNNoh0w-878dH5ybOAp7m4';
        
        // Initialize Supabase client
        const { createClient } = supabase;
        const supabaseClient = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Global variables
        let currentUser = null;
        let dbManager = null;

        // Utility Functions
        function formatCurrency(value) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(value);
        }

        function hideLoading() {
            const loading = document.getElementById('loading-overlay');
            if (loading) {
                loading.classList.add('hidden');
            }
        }

        function showLoading() {
            const loading = document.getElementById('loading-overlay');
            if (loading) {
                loading.classList.remove('hidden');
            }
        }

        // Show/Hide Sections
        function showSection(sectionName, event) {
            if (event) {
                event.preventDefault();
            }

            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Remove active class from all menu items
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected section
            const section = document.getElementById(sectionName + '-section');
            if (section) {
                section.style.display = 'block';
            }
            
            // Add active class to clicked menu item
            if (event && event.currentTarget) {
                event.currentTarget.classList.add('active');
            }
        }

        // Modal Functions
        function openModal(modalType) {
            const modal = document.getElementById(modalType + '-modal');
            if (modal) {
                modal.classList.add('active');
            }
        }

        function closeModal(modalType) {
            const modal = document.getElementById(modalType + '-modal');
            if (modal) {
                modal.classList.remove('active');
            }
            
            // Clear form if it's funcion√°rio modal
            if (modalType === 'funcionario') {
                document.getElementById('funcionario-form').reset();
                document.getElementById('funcionario-id').value = '';
                document.getElementById('funcionario-modal-title').textContent = 'Novo Funcion√°rio';
            }
        }

        // Logout function (simplified - just reload page)
        function logout() {
            if (confirm('Deseja realmente sair do sistema?')) {
                window.location.reload();
            }
        }

        // Database Manager Class
        class DatabaseManager {
            constructor(client) {
                this.client = client;
            }

            // Funcion√°rios
            async addFuncionario(data) {
                try {
                    const { data: result, error } = await this.client
                        .from('funcionarios')
                        .insert([{
                            ...data,
                            created_at: new Date().toISOString()
                        }])
                        .select();

                    if (error) throw error;
                    console.log("Funcion√°rio adicionado:", result);
                    return result[0].id;
                } catch (error) {
                    console.error("Erro ao adicionar funcion√°rio:", error);
                    alert("Erro ao adicionar funcion√°rio!");
                }
            }

            async updateFuncionario(id, data) {
                try {
                    const { error } = await this.client
                        .from('funcionarios')
                        .update({
                            ...data,
                            updated_at: new Date().toISOString()
                        })
                        .eq('id', id);

                    if (error) throw error;
                    console.log("Funcion√°rio atualizado");
                } catch (error) {
                    console.error("Erro ao atualizar funcion√°rio:", error);
                    alert("Erro ao atualizar funcion√°rio!");
                }
            }

            async deleteFuncionario(id) {
                try {
                    const { error } = await this.client
                        .from('funcionarios')
                        .delete()
                        .eq('id', id);

                    if (error) throw error;
                    console.log("Funcion√°rio removido");
                } catch (error) {
                    console.error("Erro ao remover funcion√°rio:", error);
                    alert("Erro ao remover funcion√°rio!");
                }
            }

            // Transa√ß√µes
            async addTransacao(data) {
                try {
                    const { data: result, error } = await this.client
                        .from('transacoes')
                        .insert([{
                            ...data,
                            created_at: new Date().toISOString()
                        }])
                        .select();

                    if (error) throw error;
                    console.log("Transa√ß√£o adicionada:", result);
                    return result[0].id;
                } catch (error) {
                    console.error("Erro ao adicionar transa√ß√£o:", error);
                    alert("Erro ao adicionar transa√ß√£o!");
                }
            }

            // Contatos
            async addContato(data) {
                try {
                    const { data: result, error } = await this.client
                        .from('contatos')
                        .insert([{
                            ...data,
                            created_at: new Date().toISOString()
                        }])
                        .select();

                    if (error) throw error;
                    console.log("Contato adicionado:", result);
                    return result[0].id;
                } catch (error) {
                    console.error("Erro ao adicionar contato:", error);
                    alert("Erro ao adicionar contato!");
                }
            }
        }

        // Update Tables Functions
        function updateFuncionariosTable(funcionarios) {
            const tbody = document.getElementById('funcionarios-tbody');
            if (!tbody) return;
            
            if (funcionarios.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" style="text-align: center;">Nenhum funcion√°rio cadastrado</td></tr>';
                return;
            }

            tbody.innerHTML = funcionarios.map(f => `
                <tr>
                    <td>${f.nome || ''}</td>
                    <td>${f.cpf || ''}</td>
                    <td>${f.cargo || ''}</td>
                    <td>${f.departamento || ''}</td>
                    <td>${f.admissao ? new Date(f.admissao).toLocaleDateString('pt-BR') : ''}</td>
                    <td>${formatCurrency(f.salario || 0)}</td>
                    <td><span class="status-badge ${f.status}">${f.status || 'ativo'}</span></td>
                    <td class="action-buttons">
                        <button class="btn btn-small" onclick="editFuncionario('${f.id}')">‚úèÔ∏è</button>
                        <button class="btn btn-small btn-danger" onclick="deleteFuncionario('${f.id}')">üóëÔ∏è</button>
                    </td>
                </tr>
            `).join('');
        }

        function updateTransacoesTable(transacoes) {
            const tbody = document.getElementById('transacoes-tbody');
            if (!tbody) return;
            
            if (transacoes.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center;">Nenhuma transa√ß√£o registrada</td></tr>';
                return;
            }

            tbody.innerHTML = transacoes.slice(0, 10).map(t => `
                <tr>
                    <td>${t.data ? new Date(t.data).toLocaleDateString('pt-BR') : ''}</td>
                    <td>${t.descricao || ''}</td>
                    <td>${t.categoria || ''}</td>
                    <td><span class="status-badge ${t.tipo === 'receita' ? 'entrada' : 'saida'}">${t.tipo === 'receita' ? 'Entrada' : 'Sa√≠da'}</span></td>
                    <td>${formatCurrency(t.valor || 0)}</td>
                    <td>${t.status === 'pago' ? '‚úÖ Pago' : '‚è≥ Pendente'}</td>
                </tr>
            `).join('');
        }

        function updateContatosTable(contatos) {
            const tbody = document.getElementById('contatos-tbody');
            if (!tbody) return;
            
            if (contatos.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center;">Nenhum contato cadastrado</td></tr>';
                return;
            }

            tbody.innerHTML = contatos.map(c => `
                <tr>
                    <td>${c.nome || ''}</td>
                    <td><span class="status-badge ${c.tipo === 'cliente' ? 'entrada' : 'saida'}">${c.tipo === 'cliente' ? 'Cliente' : 'Fornecedor'}</span></td>
                    <td>${c.documento || ''}</td>
                    <td>${c.telefone || ''}</td>
                    <td>${c.email || ''}</td>
                    <td class="action-buttons">
                        <button class="btn btn-small">‚úèÔ∏è</button>
                        <button class="btn btn-small btn-danger">üóëÔ∏è</button>
                    </td>
                </tr>
            `).join('');
        }

        // Setup Real-time Listeners
        async function setupRealtimeListeners() {
            // Funcion√°rios subscription
            supabaseClient
                .channel('funcionarios_changes')
                .on('postgres_changes', { event: '*', schema: 'public', table: 'funcionarios' }, 
                    async () => {
                        await loadFuncionarios();
                    }
                )
                .subscribe();

            // Transa√ß√µes subscription
            supabaseClient
                .channel('transacoes_changes')
                .on('postgres_changes', { event: '*', schema: 'public', table: 'transacoes' }, 
                    async () => {
                        await loadTransacoes();
                    }
                )
                .subscribe();

            // Contatos subscription
            supabaseClient
                .channel('contatos_changes')
                .on('postgres_changes', { event: '*', schema: 'public', table: 'contatos' }, 
                    async () => {
                        await loadContatos();
                    }
                )
                .subscribe();

            // Initial load
            await loadFuncionarios();
            await loadTransacoes();
            await loadContatos();
        }

        // Load data functions
        async function loadFuncionarios() {
            try {
                const { data, error } = await supabaseClient
                    .from('funcionarios')
                    .select('*')
                    .order('nome');

                if (error) throw error;

                let totalSalario = 0;
                let ativos = 0;
                let inativos = 0;

                data.forEach(f => {
                    if (f.status === 'ativo') {
                        ativos++;
                        totalSalario += parseFloat(f.salario || 0);
                    } else {
                        inativos++;
                    }
                });

                // Update stats
                document.getElementById('total-funcionarios').textContent = data.length;
                document.getElementById('funcionarios-ativos').textContent = ativos;
                document.getElementById('funcionarios-inativos').textContent = inativos;
                document.getElementById('folha-pagamento').textContent = formatCurrency(totalSalario);

                // Update table
                updateFuncionariosTable(data);
            } catch (error) {
                console.error('Error loading funcionarios:', error);
            }
        }

        async function loadTransacoes() {
            try {
                const { data, error } = await supabaseClient
                    .from('transacoes')
                    .select('*')
                    .order('data', { ascending: false });

                if (error) throw error;

                let totalEntradas = 0;
                let totalSaidas = 0;

                data.forEach(t => {
                    if (t.tipo === 'receita') {
                        totalEntradas += parseFloat(t.valor || 0);
                    } else {
                        totalSaidas += parseFloat(t.valor || 0);
                    }
                });

                // Update dashboard
                document.getElementById('total-entradas').textContent = formatCurrency(totalEntradas);
                document.getElementById('total-saidas').textContent = formatCurrency(totalSaidas);
                document.getElementById('resultado-mes').textContent = formatCurrency(totalEntradas - totalSaidas);

                // Update table
                updateTransacoesTable(data);
            } catch (error) {
                console.error('Error loading transacoes:', error);
            }
        }

        async function loadContatos() {
            try {
                const { data, error } = await supabaseClient
                    .from('contatos')
                    .select('*')
                    .order('nome');

                if (error) throw error;

                let clientes = 0;
                let fornecedores = 0;

                data.forEach(c => {
                    if (c.tipo === 'cliente') {
                        clientes++;
                    } else {
                        fornecedores++;
                    }
                });

                // Update stats
                document.getElementById('total-contatos').textContent = data.length;
                document.getElementById('total-clientes').textContent = clientes;
                document.getElementById('total-fornecedores').textContent = fornecedores;

                // Update table
                updateContatosTable(data);
            } catch (error) {
                console.error('Error loading contatos:', error);
            }
        }

        // Global Functions
        window.editFuncionario = async (id) => {
            try {
                const { data, error } = await supabaseClient
                    .from('funcionarios')
                    .select('*')
                    .eq('id', id)
                    .single();

                if (error) throw error;
                
                // Fill form
                document.getElementById('funcionario-id').value = id;
                document.getElementById('funcionario-nome').value = data.nome || '';
                document.getElementById('funcionario-cpf').value = data.cpf || '';
                document.getElementById('funcionario-email').value = data.email || '';
                document.getElementById('funcionario-telefone').value = data.telefone || '';
                document.getElementById('funcionario-cargo').value = data.cargo || '';
                document.getElementById('funcionario-departamento').value = data.departamento || '';
                document.getElementById('funcionario-admissao').value = data.admissao || '';
                document.getElementById('funcionario-salario').value = formatCurrency(data.salario || 0);
                document.getElementById('funcionario-status').value = data.status || 'ativo';
                
                document.getElementById('funcionario-modal-title').textContent = 'Editar Funcion√°rio';
                openModal('funcionario');
            } catch (error) {
                console.error('Error loading funcionario:', error);
                alert('Erro ao carregar funcion√°rio');
            }
        };

        window.deleteFuncionario = async (id) => {
            if (confirm('Tem certeza que deseja remover este funcion√°rio?')) {
                await dbManager.deleteFuncionario(id);
            }
        };

        // Popular clientes
        window.popularClientes = async () => {
            const clientesIniciais = [
                {
                    tipo: 'cliente',
                    nome: 'AGRITEX COMERCIAL AGRICOLA LTDA',
                    documento: '06.098.802/0001-62',
                    email: 'financeiro.pagar@agritex.com.br',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'AGRICULTURA E PECUARIA CAMPONOVENSE LTDA',
                    documento: '39.429.668/0001-94',
                    email: 'financeiro@agrocam.com.br',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'ARGO INTELIGENCIA DIGITAL LTDA',
                    documento: '39.752.281/0001-74',
                    email: 'FINANCEIRO@ARGOINTELIGENCIA.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'CARISMA INVESTIMENTOS E PARTICIPACOES S/A',
                    documento: '07.701.775/0001-33',
                    email: 'CARISMAPVA@GMAIL.COM',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'CARVALIMA TRANSPORTES LTDA',
                    documento: '35.070.814/0001-51',
                    email: 'VALDECIR@CARVALIMA.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'COMPLEXO TURISTICO SANTA ROSA PANTANAL HOTEIS LTDA',
                    documento: '03.785.623/0001-05',
                    email: 'FINANCEIRO@SANTAROSAPANTANAL.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'DUILIO NAVES JUNQUEIRA JUNIOR',
                    documento: '343.588.541-68',
                    email: 'duilio@odomprimeculaba.com.br',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'E. R. DE FIGUEIREDO & CIA LTDA',
                    documento: '30.541.222/0001-82',
                    email: 'elsonramos@live.com',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'ESTANCIA BAHIA EVENTOS LTDA',
                    documento: '26.373.673/0001-80',
                    email: 'CONTABILIDADE@ESTANCIABAHIA.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'EUGENIO ROBERTO BERGAMIM',
                    documento: '041.476.781-06',
                    email: '',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'GA SERVICE - GESTAO ADMINISTRATIVA LTDA',
                    documento: '10.942.203/0001-50',
                    email: 'NOTIFICACOES@GRUPOALDO.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'GRF INCORPORADORA E CONSTRUTORA LTDA',
                    documento: '32.187.187/0001-70',
                    email: 'FISCAL@EXATUSONLINE.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'NOGUEIRA PARTICIPACOES E EMPREENDIMENTOS LTDA',
                    documento: '12.645.475/0001-14',
                    email: 'ADRIANO@NOGUEIRACONTABIL.COM',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'NOVA ALIANCA AGRO LTDA',
                    documento: '28.080.165/0001-30',
                    email: 'EDSON@NOVAALIANCAAGRO.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'R.O.G HOLDING LTDA',
                    documento: '40.988.927/0001-04',
                    email: 'RAPHAELCOALASOCIAL@GMAIL.COM',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'RICARDO GOMES DOS SANTOS',
                    documento: '784.754.651-53',
                    email: 'ricardo@tunnaseguros.com.br',
                    telefone: '65992517629'
                },
                {
                    tipo: 'cliente',
                    nome: 'SOLUCAO TECNICA COMERCIO E SERVICOS DE EQUIPAMENTOS ELETRONICOS LTDA',
                    documento: '04.164.120/0001-85',
                    email: 'ADMINISTRATIVO@SOLUCAOTECNICA.COM.BR',
                    telefone: ''
                },
                {
                    tipo: 'cliente',
                    nome: 'WATT - DISTRIBUIDORA BRASIL. DE COMBUSTIVEIS E DERIVADOS DE PETROLEO LTDA',
                    documento: '03.908.643/0001-26',
                    email: 'GERENTECOMERCIAL@WATTBRAS.COM.BR',
                    telefone: ''
                }
            ];

            if (confirm('Deseja importar os 18 clientes iniciais? Isso n√£o duplicar√° clientes existentes.')) {
                showLoading();
                try {
                    for (const cliente of clientesIniciais) {
                        // Verificar se cliente j√° existe pelo CNPJ
                        const { data: existing } = await supabaseClient
                            .from('contatos')
                            .select('id')
                            .eq('documento', cliente.documento)
                            .single();
                        
                        if (!existing) {
                            await supabaseClient
                                .from('contatos')
                                .insert([{
                                    ...cliente,
                                    created_at: new Date().toISOString()
                                }]);
                            console.log(`Cliente ${cliente.nome} adicionado`);
                        } else {
                            console.log(`Cliente ${cliente.nome} j√° existe`);
                        }
                    }
                    alert('Importa√ß√£o conclu√≠da!');
                    await loadContatos();
                } catch (error) {
                    console.error('Erro na importa√ß√£o:', error);
                    alert('Erro ao importar clientes');
                } finally {
                    hideLoading();
                }
            }
        };

        // Initialize Application
        async function initializeApp() {
            try {
                // Update user info
                const userEmail = localStorage.getItem('sharebrasilUser');
                if (userEmail) {
                    document.querySelectorAll('.user-name').forEach(el => {
                        el.textContent = userEmail.split('@')[0];
                    });
                }

                // Initialize Database Manager
                dbManager = new DatabaseManager(supabaseClient);
                window.dbManager = dbManager;

                // Setup listeners
                await setupRealtimeListeners();

                // Setup forms
                setupForms();

                // Hide loading
                hideLoading();

                console.log('Application initialized successfully');
            } catch (error) {
                console.error('Error initializing application:', error);
                hideLoading();
            }
        }

        // Setup Forms
        function setupForms() {
            // Funcion√°rio Form
            const funcionarioForm = document.getElementById('funcionario-form');
            if (funcionarioForm) {
                funcionarioForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const id = document.getElementById('funcionario-id').value;
                    const data = {
                        nome: document.getElementById('funcionario-nome').value,
                        cpf: document.getElementById('funcionario-cpf').value,
                        email: document.getElementById('funcionario-email').value,
                        telefone: document.getElementById('funcionario-telefone').value,
                        cargo: document.getElementById('funcionario-cargo').value,
                        departamento: document.getElementById('funcionario-departamento').value,
                        admissao: document.getElementById('funcionario-admissao').value,
                        salario: document.getElementById('funcionario-salario').value.replace(/[^\d,]/g, '').replace(',', '.'),
                        status: document.getElementById('funcionario-status').value
                    };

                    if (id) {
                        await dbManager.updateFuncionario(id, data);
                    } else {
                        await dbManager.addFuncionario(data);
                    }
                    
                    closeModal('funcionario');
                    e.target.reset();
                });
            }

            // Lan√ßamento Form
            const lancamentoForm = document.getElementById('lancamento-form');
            if (lancamentoForm) {
                lancamentoForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const data = {
                        tipo: document.getElementById('lancamento-tipo').value,
                        descricao: document.getElementById('lancamento-descricao').value,
                        categoria: document.getElementById('lancamento-categoria').value,
                        valor: document.getElementById('lancamento-valor').value.replace(/[^\d,]/g, '').replace(',', '.'),
                        data: document.getElementById('lancamento-data').value,
                        status: 'pendente'
                    };

                    await dbManager.addTransacao(data);
                    
                    closeModal('lancamento');
                    e.target.reset();
                });
            }

            // Contato Form
            const contatoForm = document.getElementById('contato-form');
            if (contatoForm) {
                contatoForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const data = {
                        tipo: document.getElementById('contato-tipo').value,
                        nome: document.getElementById('contato-nome').value,
                        documento: document.getElementById('contato-documento').value,
                        email: document.getElementById('contato-email').value,
                        telefone: document.getElementById('contato-telefone').value
                    };

                    await dbManager.addContato(data);
                    
                    closeModal('contato');
                    e.target.reset();
                });
            }

            // Format currency inputs
            document.querySelectorAll('input[placeholder*="R$"]').forEach(input => {
                input.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    value = (value / 100).toFixed(2);
                    value = value.replace('.', ',');
                    e.target.value = 'R$ ' + value;
                });
            });

            // Notes autosave
            const notesContent = document.querySelector('.notes-content');
            if (notesContent) {
                notesContent.addEventListener('blur', function() {
                    localStorage.setItem('quickNotes', this.value);
                });

                // Load saved notes
                const savedNotes = localStorage.getItem('quickNotes');
                if (savedNotes) {
                    notesContent.value = savedNotes;
                }
            }
        }

        // Close modals when clicking outside
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });

        // Check authentication on load
        window.addEventListener('load', async () => {
            showLoading();
            
            // Check if user is logged in
            const { data: { session } } = await supabaseClient.auth.getSession();
            
            if (session) {
                currentUser = session.user;
                hideLogin();
                await initializeApp();
            } else {
                hideLoading();
                showLogin();
            }
        });

        // Make functions available globally
        window.showSection = showSection;
        window.openModal = openModal;
        window.closeModal = closeModal;
        window.formatCurrency = formatCurrency;
        window.logout = logout;
    </script>
</body>
</html>
